#!/bin/bash

# Auto-switch environment on branch change
# main = production, others = staging

[ "$3" != "1" ] && exit 0

BRANCH=$(git symbolic-ref --short HEAD 2>/dev/null)
PROJECT_ROOT=$(git rev-parse --show-toplevel)

if [ "$BRANCH" = "main" ]; then
    "$PROJECT_ROOT/scripts/switch-env.sh" production
else
    "$PROJECT_ROOT/scripts/switch-env.sh" staging
fi
